!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("react"),require("react-redux"),require("antd"),require("styled-components"),require("axios"),require("qs"),require("react-dom")):"function"==typeof define&&define.amd?define(["exports","react","react-redux","antd","styled-components","axios","qs","react-dom"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).AuthSDK={},e.React,e.ReactRedux,e.antd,e.styled,e.axios,e.Qs,e.ReactDOM)}(this,(function(e,n,t,r,o,a,i,l){"use strict";function u(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var c=u(n),d=u(o),s=u(a),f=u(i),p=u(l),g=function(){return(g=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)};function v(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(t[r[o]]=e[r[o]])}return t}function m(e,n,t,r){return new(t||(t=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(n){a(n)}}function l(e){try{u(r.throw(e))}catch(n){a(n)}}function u(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,l)}u((r=r.apply(e,n||[])).next())}))}function h(e,n){var t,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=n.call(e,i)}catch(l){a=[6,l],r=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}function M(e,n){return Object.defineProperty?Object.defineProperty(e,"raw",{value:n}):e.raw=n,e}function y(e){if(!e)return{};var n=e.startsWith("//")?""+window.location.protocol+e:e,t={},r=["href","origin","protocol","host","hostname","port","pathname","search","hash"],o=/(([^:]+:)\/\/(([^:/?#]+)(:\d+)?))(\/[^?#]*)?(\?[^#]*)?(#.*)?/.exec(n);if(o)for(var a=r.length-1;a>=0;--a)t[r[a]]=o[a]?o[a]:"";return t}var E=function(e,n){return s.default(g({url:e,withCredentials:!0,paramsSerializer:function(e){return f.default.stringify(e,{arrayFormat:"repeat",allowDots:!0})}},n))},w=function(e){return void 0===e&&(e=window.location.origin),e+"/gateway/v1/user?requireAvatar=true"},I=function(e){return void 0===e&&(e=window.location.origin),e+"/gateway/v1/login"},N=function(e){return e+"/oauth/authorize"},A=function(e){return e+"/djcsupport/domainname/getPlatformConfigure"},O=function(e,n,t){return t||(n?e+"@"+n:"plat@"+e)},T=function(e,n){return n||(e||window.location.origin)+"/login-app/login-success/index.html"},D=function(e){var n=e.origin,t=void 0===n?window.location.origin:n,r=e.whoAmIHost,o=e.whoAmIhost,a=e.djcGatewayBaseUrl,i=e.platId,l=e.dp,u=e.ui,c=e.registerNoHeader,d=e.title,s=e.clientId,f=e.loginSuccessRedirectUri,p=e.loginSucessRedirectTarget,v=e.limitOrgTypes,M=e.errorMessage,w=e.extraParams;return m(void 0,void 0,void 0,(function(){var e,n,m,N;return h(this,(function(h){switch(h.label){case 0:return e=y(t).host,n=i,i?[3,2]:[4,E(A(a),{params:{orgDomainName:e}})];case 1:m=h.sent().data,n=null==m?void 0:m.platformCode,h.label=2;case 2:return n?[2,g(g({},w),{ui:u,register_no_header:c,title:d,client_id:O(n,l,s),scope:r||o||e,login_sucess_redirect_uri:T(t,f),login_sucess_redirect_target:p,redirect_uri:I(t),is_fpa:!0,error_message:M,options:v&&{limitOrgTypes:v}})]:(N="未查询到 "+e+" 对应的平台信息, 请检查平台配置是否正确",console.log(N),[2,Promise.reject(new Error(N))])}}))}))},_=function(e,n){return m(void 0,void 0,void 0,(function(){var t;return h(this,(function(r){switch(r.label){case 0:return[4,E(N(e),{headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"},params:g(g({},n),{tenantId:"gmsoft-web"})})];case 1:return[2,(null==(t=r.sent())?void 0:t.data)||{}]}}))}))},P=function(){try{return(null===top||void 0===top?void 0:top.document.querySelector("#mount-root"))||top.document.body}catch(e){return document.body}};function S(e){return e&&e.parentNode?e.parentNode:P()}var b,C="gmsoft-ui-top-body-need-inject-css",j=function(e){top[C]=e},x=o.createGlobalStyle(b||(b=M(["\n  body{\n    position: relative;\n    width: calc(100% - 17px);\n    overflow: hidden;\n    touch-action: none;\n  }\n"],["\n  body{\n    position: relative;\n    width: calc(100% - 17px);\n    overflow: hidden;\n    touch-action: none;\n  }\n"]))),R=function(){var e=n.useState((function(){return void 0===top[C]&&j(!0),top[C]}))[0];return n.useEffect((function(){return j(!1),function(){j(!0)}})),e?c.default.createElement(x,null):null},z=P(),L=function(e){var n=e.children,t=e.width,a=e.getContainer,i=v(e,["children","width","getContainer"]);return!0!==i.visible?null:c.default.createElement(o.StyleSheetManager,{target:z},c.default.createElement(c.default.Fragment,null,c.default.createElement(R,null),c.default.createElement(r.Modal,g({getContainer:a||P,width:t},i),c.default.createElement(r.ConfigProvider,{getPopupContainer:S},n))))},k=function(e){return function(n){return r.Modal[e](g({getContainer:P},n))}};L.info=k("info"),L.success=k("success"),L.error=k("error"),L.warning=k("warning"),L.confirm=k("confirm"),L.destroyAll=r.Modal.destroyAll;var U,Y="ant",G=function(){},H=d.default(L)(U||(U=M(["\n  &&& .","-modal-body {\n    border: 3px solid #666666;\n    border-radius: 3px;\n    padding: 0;\n  }\n"],["\n  &&& .","-modal-body {\n    border: 3px solid #666666;\n    border-radius: 3px;\n    padding: 0;\n  }\n"])),Y),Q=function(e,n,t){G&&G();var r=document.createElement("div");document.body.appendChild(r);var o=function(){return p.default.unmountComponentAtNode(r)};return G=function(){n&&"function"==typeof n&&n(),o()},p.default.render(c.default.createElement(H,{visible:!0,maskClosable:!0,closable:!1,footer:null,closeIcon:null,onCancel:G,width:366},c.default.createElement("iframe",{title:"loginBox",className:"login-form-box",src:e,width:"360px",height:"440px",scrolling:"no",style:{margin:0,padding:0,display:"block"},frameBorder:"0"})),r),t&&(t.current=o),o};var F=function(e){var n,t,r,o,a,i,l,u,c,d,s,f,p;if(e&&0!==Object.getOwnPropertyNames(e).length)return g({admin:(p=null==e?void 0:e.roles,!!p&&-1!==p.findIndex((function(e){return String(e).endsWith("01")}))),adminAreaId:null===(n=null==e?void 0:e.org)||void 0===n?void 0:n.areaId,adminAreaName:null===(t=null==e?void 0:e.org)||void 0===t?void 0:t.areaName,maintainPlatId:null===(r=null==e?void 0:e.additionalInformation)||void 0===r?void 0:r.mpi,orgId:null===(o=null==e?void 0:e.org)||void 0===o?void 0:o.orgId,orgName:null===(a=null==e?void 0:e.org)||void 0===a?void 0:a.orgName,orgType:null===(i=null==e?void 0:e.org)||void 0===i?void 0:i.orgType,userName:null==e?void 0:e.realName,userTypes:(null==e?void 0:e.roles)?null==e?void 0:e.roles.join(","):void 0,deptRole:null===(l=null==e?void 0:e.additionalInformation)||void 0===l?void 0:l.deptRole,isBidDown:null===(u=null==e?void 0:e.additionalInformation)||void 0===u?void 0:u.isBidDown,isSj:null===(c=null==e?void 0:e.additionalInformation)||void 0===c?void 0:c.isSj,orgClassNo:null===(d=null==e?void 0:e.additionalInformation)||void 0===d?void 0:d.orgClassNo,organClass:null===(s=null==e?void 0:e.additionalInformation)||void 0===s?void 0:s.organClass,userType:null===(f=null==e?void 0:e.additionalInformation)||void 0===f?void 0:f.userType},e)},B=function(e,n,t){return m(void 0,void 0,void 0,(function(){var r,o,a,i;return h(this,(function(l){switch(l.label){case 0:return[4,E(w(n),{params:(i={},i.__platDomain__=t,i)})];case 1:return r=l.sent(),(o=r.data)&&0!==Object.getOwnPropertyNames(o).length?(a=F(r.data),n&&!window.location.origin.includes(n)||function(e,n){e&&e({type:"@@GLOBAL_CONTEXT/SET",payload:{me:n}})}(e,a),[2,a]):[2,Promise.reject()]}}))}))},V=function(e,n){return m(void 0,void 0,void 0,(function(){var e,t;return h(this,(function(r){switch(r.label){case 0:return[2,n+"/authing"];case 1:return e=r.sent(),[2,null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.op]}}))}))},q=function(e){if(!e)throw new Error("mode =  page, 必须指定 loginPage");window.open(e,"_top")},K=function(e){var n=e.mode,t=e.origin,r=void 0===t?window.location.origin:t,o=e.whoAmIHost,a=e.whoAmIhost,i=e.clientId,l=e.platId,u=e.dp,c=e.ui,d=e.registerNoHeader,s=e.title,f=e.loginPage,p=e.djcGatewayBaseUrl,g=e.loginSuccessRedirectUri,v=e.loginSucessRedirectTarget,M=void 0===v?"_self":v,E=e.limitOrgTypes,w=e.oauthState,I=e.onCancelLogin,N=e.closePopupRef,A=e.dispatch;return m(void 0,void 0,void 0,(function(){var e,t,v,m,O,T,P,S,b,C,j,x,R;return h(this,(function(h){switch(h.label){case 0:e=y(r).host,t=o||a||e,h.label=1;case 1:return h.trys.push([1,3,,12]),[4,B(A,r,t)];case 2:return[2,h.sent()];case 3:return h.sent(),[4,D({origin:r,whoAmIHost:t,djcGatewayBaseUrl:p,clientId:i,platId:l,dp:u,ui:c,registerNoHeader:d,title:s,loginSuccessRedirectUri:g,loginSucessRedirectTarget:M,limitOrgTypes:E,extraParams:w})];case 4:return v=h.sent(),[4,V(0,p)];case 5:m=h.sent(),h.label=6;case 6:return h.trys.push([6,10,,11]),[4,_(m,{response_type:"code",client_id:v.client_id,redirect_uri:v.redirect_uri,scope:v.scope,options:v.options,state:JSON.stringify(v)})];case 7:return O=h.sent(),T=O.location,0!==O.res?[3,9]:[4,B(A,r,t).catch((function(){console.error("服务器错误, 登录成功, 但获取登录用户信息失败!")}))];case 8:return[2,h.sent()];case 9:if("page"===n&&q(f),"popup"===n){if(T)return[2,Q(T,I,N)];console.log("login error, mode=popup, authorize not response location")}return"sso"===n?[2,Promise.reject(new Error("尝试单点登录失败"))]:[3,11];case 10:return P=h.sent(),b=(null===(j=null===(C=null==(S=P)?void 0:S.response)||void 0===C?void 0:C.data)||void 0===j?void 0:j.error_message)||(null===(R=null===(x=null==S?void 0:S.response)||void 0===x?void 0:x.data)||void 0===R?void 0:R.message)||S.message||"服务器端错误",console.error(b,P),"page"===n&&q(f),[3,11];case 11:return[3,12];case 12:return[2]}}))}))},Z=function(e){return K(g(g({},e),{mode:"sso"}))},X=function(e){return e.then((function(e){return{value:e,status:"resolved"}}),(function(e){return{error:e,status:"rejected"}}))};function $(e,n){return void 0===n&&(n=1),n>0?e.reduce((function(e,t){return e.concat(Array.isArray(t)?$(t,n-1):t)}),[]):e.slice()}var J,W,ee,ne,te,re,oe,ae,ie=function(e){void 0===e&&(e=[]);var n=e.filter((function(e){return e})).map((function(e){return n=e,void 0===t&&(t=5e3),new Promise((function(e,r){var o=new Image(0,0);o.onload=e,o.onerror=r,o.src=n,setTimeout((function(){r()}),t)}));var n,t}));return Promise.all(n.map(X))},le=function(e,n){return m(void 0,void 0,void 0,(function(){var t,r,o,a,i;return h(this,(function(l){switch(l.label){case 0:return[4,E(e+"/logout",{method:"DELETE"})];case 1:return t=l.sent().data,r=t.apps||[],t.ops&&t.ops.length>0?(o=t.ops.map((function(e){return E(e,{method:"DELETE"}).catch((function(){}))})),[4,Promise.all(o)]):[3,3];case 2:(a=l.sent())&&a.length>0&&(r=r.concat($(a.map((function(e){var n;return null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.apps}))))),l.label=3;case 3:return n&&n.length>0&&(r=r.concat(n)),i=window.location.origin+"/gateway/v1/logout",r.includes(i)||r.push(i),[4,ie(r)];case 4:return l.sent(),[2]}}))}))},ue=function(e){return m(void 0,void 0,void 0,(function(){var n,t=e.logoutRedirectUrl,r=e.logoutRedirectTarget,o=e.otherLogoutUrls,a=v(e,["logoutRedirectUrl","logoutRedirectTarget","otherLogoutUrls"]);return h(this,(function(e){switch(e.label){case 0:return e.trys.push([0,,3,7]),[4,V(a.origin,a.djcGatewayBaseUrl)];case 1:return n=e.sent(),[4,le(n,o)];case 2:return e.sent(),[3,7];case 3:return t?(window.open(t,r||"_top"),[3,6]):[3,4];case 4:return[4,K(a)];case 5:e.sent(),e.label=6;case 6:return[7];case 7:return[2]}}))}))},ce=function(e){var n=e.authPageOrigin,t=e.origin,r=e.ui,o=e.dp,a=e.djcGatewayBaseUrl,i=e.noHeader;return m(void 0,void 0,void 0,(function(){var e,l,u;return h(this,(function(c){switch(c.label){case 0:return e=n+"/register/select-type",l=null,[4,E(A(a),{params:{orgDomainName:t?y(t).host:window.location.host}})];case 1:return u=c.sent().data,l=null==u?void 0:u.platformCode,window.open(""+e+f.default.stringify({ui:r,platId:l,dp:o,noHeader:i},{addQueryPrefix:!0,encode:!1}),"_blank"),[2]}}))}))},de=function(e){return e.globalContext.me},se=function(e){return m(void 0,void 0,void 0,(function(){var n;return h(this,(function(t){switch(t.label){case 0:return[4,Z(e)];case 1:return(n=t.sent())?[2,n]:[2,Promise.reject()]}}))}))},fe=c.default.createContext({mode:"page",authPageOrigin:"",loginPage:"",djcGatewayBaseUrl:"",loginSuccessRedirectUri:"/login-app/login-success/index.html",toCenterPage:function(){},dispatch:function(e){return e}}),pe=function(e){var t=e.path,o=e.className,a=n.useContext(fe).djcGatewayBaseUrl,i=n.useMemo((function(){return t?a+"/files?business=avatar&filePath="+t+"&fileName=file&attachment=false&contentType=image/png":"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgiIGhlaWdodD0iNDkiIHZpZXdCb3g9IjAgMCA0OCA0OSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTQ4IDI0LjAyNjRDNDggMzcuMjY3MyAzNy4yNTQxIDQ4LjAwMzEgMjMuOTk3NSA0OC4wMDMxQzEwLjc0MjEgNDguMDAzMSAwIDM3LjI2NzMgMCAyNC4wMjY0QzAgMTMuODYzIDYuMzI2MDUgNS4xNzk4NyAxNS4yNjAyIDEuNjkwMzNDMTcuOTU5NiAwLjYwMTM3NiAyMC45MDg3IDAgMjMuOTk4MSAwQzI3LjA5MTMgMCAzMC4wMzc5IDAuNjAwNzY5IDMyLjczOTggMS42OTAzM0M0MS42NzM0IDUuMTc5ODcgNDggMTMuODYzIDQ4IDI0LjAyNjRaTTE0Ljc3MzMgMTguOTY5OUMxNC43NzMzIDIzLjAxMDUgMTYuODQzNiAyNi41MDg4IDE5Ljg1MzEgMjguMjIxMUMyMS4xMDEyIDI4LjkzMTQgMjIuNTA2NSAyOS4zNDA5IDIzLjk5NzUgMjkuMzQwOUMyNS40MzYxIDI5LjM0MDkgMjYuNzkyNSAyOC45NTc4IDI4LjAwNzkgMjguMjk2QzMxLjA4ODUgMjYuNjE2MyAzMy4yMjU1IDIzLjA3NTMgMzMuMjI1NSAxOC45NzA1QzMzLjIyNTUgMTMuMjU1MyAyOS4wODY4IDguNjAzMjggMjMuOTk3NSA4LjYwMzI4QzE4LjkxMTQgOC42MDI2NyAxNC43NzMzIDEzLjI1NDcgMTQuNzczMyAxOC45Njk5Wk0yNC4wOTUgNDYuNDQ5NEMzMS4xMDY3IDQ2LjQ0OTQgMzcuMzYxNiA0My4yMjQ3IDQxLjQ2MTMgMzguMTc4M0M0MC45NzcgMzQuMTk3NSAzNy4wOTggMzAuODA4NiAzMS42MDgxIDI5LjExODJDMjkuNTM0NyAzMC45ODM1IDI2Ljg4NTYgMzIuMTA1OCAyMy45OTY4IDMyLjEwNThDMjEuMDQzOSAzMi4xMDU4IDE4LjM0MDggMzAuOTIzMSAxNi4yNDcyIDI4Ljk3NjdDMTAuOTA2OSAzMC41MDA5IDYuOTk1MzIgMzMuNjA5OSA2LjA3ODE4IDM3LjMzNTNDMTAuMTQ2NCA0Mi44NjE3IDE2LjcwMzMgNDYuNDQ5NCAyNC4wOTUgNDYuNDQ5NFoiIGZpbGw9IiNDRUNGRTAiLz4KPC9zdmc+Cg=="}),[a,t]);return c.default.createElement(r.Avatar,{className:o,src:i})},ge=function(e){return e.theme.textColorSecondary||"#697b8c"},ve=function(e){return e.theme.linkColorHover||"#1890ff"},me=d.default.a(J||(J=M(["\n  color: ",";\n  &:active {\n    color: ",";\n  }\n  span,\n  svg {\n    vertical-align: middle;\n    color: ",";\n    fill: ",";\n  }\n  &:hover {\n    span,\n    svg {\n      color: ",";\n      fill: ",";\n    }\n  }\n"],["\n  color: ",";\n  &:active {\n    color: ",";\n  }\n  span,\n  svg {\n    vertical-align: middle;\n    color: ",";\n    fill: ",";\n  }\n  &:hover {\n    span,\n    svg {\n      color: ",";\n      fill: ",";\n    }\n  }\n"])),ge,ge,ge,ge,ve,ve),he=function(){var e=n.useContext(fe),t=n.useCallback((function(){return m(void 0,void 0,void 0,(function(){return h(this,(function(n){switch(n.label){case 0:return[4,ue(e)];case 1:return n.sent(),[2]}}))}))}),[e]);return c.default.createElement(me,{onClick:t},c.default.createElement("span",null,"退出"),c.default.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4393",width:"20",height:"20"},c.default.createElement("path",{d:"M593.92 838.513v-95.355a40.96 40.96 0 1 1 81.92 0v95.355c0 45.26-35.226 83.087-80.22 83.087H203.1c-44.994 0-80.22-37.827-80.22-83.087V185.487c0-45.26 35.226-83.087 80.22-83.087h392.52c44.994 0 80.22 37.827 80.22 83.087v193.946a40.96 40.96 0 1 1-81.92 0V185.487c0-1.024 0.061-1.147 0.901-1.167H203.9c0.84 0 0.901 0.164 0.901 1.167v653.026c0 1.024-0.061 1.147-0.901 1.167H594.82c-0.84 0-0.901-0.164-0.901-1.167z","p-id":"4394"}),c.default.createElement("path",{d:"M471.04 512h327.68q40.96 0 40.96 40.96t-40.96 40.96H471.04q-40.96 0-40.96-40.96T471.04 512z","p-id":"4395"}),c.default.createElement("path",{d:"M811.199 422.828L912.57 524.2q28.963 28.963 0 57.926t-57.926 0l-101.37-101.37q-28.964-28.964 0-57.927 28.962-28.963 57.925 0z","p-id":"4396"}),c.default.createElement("path",{d:"M753.273 625.575l101.37-101.37q28.964-28.964 57.927 0 28.963 28.962 0 57.925L811.2 683.501q-28.964 28.963-57.927 0t0-57.926z","p-id":"4397"})))},Me=r.Typography.Paragraph,ye=d.default.div(W||(W=M(["\n  &&& {\n    max-width: 280px;\n    margin-bottom: -6px;\n    .","-menu-vertical {\n      border-right: none;\n      .","-menu-item {\n        cursor: default;\n        line-height: 35px;\n        height: auto;\n        text-align: center;\n        margin: 0;\n        &.","-menu-item-selected, &:active {\n          background-color: white;\n        }\n      }\n    }\n  }\n"],["\n  &&& {\n    max-width: 280px;\n    margin-bottom: -6px;\n    .","-menu-vertical {\n      border-right: none;\n      .","-menu-item {\n        cursor: default;\n        line-height: 35px;\n        height: auto;\n        text-align: center;\n        margin: 0;\n        &.","-menu-item-selected, &:active {\n          background-color: white;\n        }\n      }\n    }\n  }\n"])),Y,Y,Y),Ee=d.default(pe)(ee||(ee=M(["\n  &&& {\n    height: 64px;\n    width: 64px;\n    vertical-align: top;\n    border: 1px solid #dedede;\n  }\n"],["\n  &&& {\n    height: 64px;\n    width: 64px;\n    vertical-align: top;\n    border: 1px solid #dedede;\n  }\n"]))),we=d.default(Me).attrs({ellipsis:!0})(ne||(ne=M(["\n  &&& {\n    margin: 0;\n  }\n"],["\n  &&& {\n    margin: 0;\n  }\n"]))),Ie=d.default(we)(te||(te=M(["\n  font-size: 16px;\n  font-weight: 700;\n"],["\n  font-size: 16px;\n  font-weight: 700;\n"]))),Ne=function(e){var t,o,a,i=e.me,l=n.useContext(fe).toCenterPage;return c.default.createElement(ye,null,c.default.createElement(r.Menu,{mode:"vertical"},c.default.createElement(r.Menu.Item,{key:"avatar"},c.default.createElement(Ee,{path:null===(t=i.additionalInformation)||void 0===t?void 0:t.avatar})),c.default.createElement(r.Menu.Item,{key:"name"},i.realName&&c.default.createElement("a",{onClick:l},c.default.createElement(Ie,null,i.realName)),(null===(o=i.org)||void 0===o?void 0:o.orgName)&&c.default.createElement(we,null,null===(a=i.org)||void 0===a?void 0:a.orgName)),c.default.createElement(r.Menu.Divider,null),c.default.createElement(r.Menu.Item,{key:"logout"},c.default.createElement(he,null))))},Ae=d.default(pe)(re||(re=M(["\n  &&& {\n    height: 24px;\n    width: 24px;\n    vertical-align: middle;\n    margin-right: 4px;\n  }\n"],["\n  &&& {\n    height: 24px;\n    width: 24px;\n    vertical-align: middle;\n    margin-right: 4px;\n  }\n"]))),Oe=r.Typography.Text,Te=d.default(Oe)(oe||(oe=M(["\n  &&& {\n    max-width: 150px;\n    vertical-align: middle;\n  }\n"],["\n  &&& {\n    max-width: 150px;\n    vertical-align: middle;\n  }\n"]))),De=function(e){var n,t=e.me;return c.default.createElement(r.Popover,{placement:"bottom",autoAdjustOverflow:!1,content:c.default.createElement(Ne,{me:t})},c.default.createElement(Ae,{path:null===(n=t.additionalInformation)||void 0===n?void 0:n.avatar}),c.default.createElement(Te,{ellipsis:!0},t.realName))},_e=function(){var e=n.useContext(fe),t=n.useCallback((function(){K(e)}),[e]);return c.default.createElement("a",{className:"login",onClick:t},"登录")},Pe=function(){var e=n.useContext(fe),t=n.useCallback((function(){ce(e)}),[e]);return c.default.createElement("a",{className:"register",onClick:t},"注册")},Se=function(){return t.useSelector(de)},be=r.Typography.Text,Ce=d.default(be).attrs({type:"secondary"})(ae||(ae=M(["\n  margin: 0 8px;\n"],["\n  margin: 0 8px;\n"]))),je=function(e){var r=e.className,o=v(e,["className"]),a=Se(),i=t.useDispatch();return n.useEffect((function(){a||se({djcGatewayBaseUrl:o.djcGatewayBaseUrl,dispatch:i}).catch((function(){}))}),[a,i,o.djcGatewayBaseUrl]),c.default.createElement(fe.Provider,{value:g({dispatch:i},o)},c.default.createElement("div",{className:r},a?c.default.createElement(De,{me:a}):c.default.createElement(c.default.Fragment,null,c.default.createElement(_e,null),c.default.createElement(Ce,null,"或"),c.default.createElement(Pe,null))))},xe={},Re=function(e){return function(n){for(;xe[e]&&xe[e].length>0;){var t=xe[e].shift();t&&n(t)}}},ze=function(e,n,t){return e(g(g({},n.config),{SSOInterceptorIgnore:!0})).then((function(e){return t&&t(),e}))},Le={};function ke(e,n,t,r){return m(this,void 0,void 0,(function(){var o,a,i;return h(this,(function(l){switch(l.label){case 0:if(o=y(n.config.url).origin,a=n.config&&n.config.params&&n.config.params.__platDomain__?n.config.params.__platDomain__:y(o).host,Le[i=o+"+"+a])return[2,new Promise((function(e,o){!function(e){return function(n){xe[e]||(xe[e]=[]),xe[e].push(n)}}(i)({response:n,resolve:e,reject:o,fetcher:t,afterRetry:r})}))];l.label=1;case 1:return l.trys.push([1,3,4,5]),Le[i]=!0,[4,Z(g(g({},e),{origin:o,whoAmIHost:a}))];case 2:return l.sent(),[3,5];case 3:return l.sent(),function(e){Re(e)((function(e){var n=e.response,t=e.reject,r=e.afterRetry;t(n),r&&r()}))}(i),[2,Promise.reject(n)];case 4:return Le[i]=!1,[7];case 5:return function(e){Re(e)((function(e){var n=e.response,t=e.resolve,r=e.fetcher,o=e.afterRetry;t(ze(r,n,o))}))}(i),[2,ze(t,n,r)]}}))}))}var Ue,Ye,Ge="__token__",He=function(){try{return window.__token_param_key__||window.history.state.__token_param_key__||Ge}catch(e){return Ge}},Qe=function(){try{return window.__token__||window.history.state.__token__}catch(e){return null}},Fe=function(e){var n=f.default.parse(window.location.search,{ignoreQueryPrefix:!0})||{},t=e||He(),r=n[t]||Qe();return function(e,n){var t;try{e&&n&&(window.__token_param_key__=e,window.__token__=n,window.history.replaceState(g(g({},window.history.state),((t={}).__token_param_key__=e,t.__token__=n,t)),""))}catch(r){}}(t,r),r},Be=function(){var e,n=He(),t=Qe();return t?((e={})[n]=t,e):null},Ve=function(e){Fe(e)},qe=function(e,n){var t,r=e.tokenParamKey,o=e.authHeaderKey;void 0===n&&(n={});var a=Fe(r);if(a){var i=g(g({},n.headers),((t={})[o||"Authorization"]=a,t));return g(g({},n),{headers:i})}return n};(Ye=Ue||(Ue={}))[Ye.PLATFORM=1]="PLATFORM",Ye[Ye.APPROVAL=2]="APPROVAL",Ye[Ye.STOCK=3]="STOCK",Ye[Ye.AGENT=4]="AGENT",Ye[Ye.PROVIDER=5]="PROVIDER",Ye[Ye.FINANCE=7]="FINANCE",Ye[Ye.EMPLOYEE=101]="EMPLOYEE",Ye[Ye.EXPERT=102]="EXPERT",Ye[Ye.TEACHER=103]="TEACHER";var Ke,Ze,Xe=Ue,$e=function(e){switch(e){case Ue.PLATFORM:return"platform";case Ue.APPROVAL:return"approval";case Ue.STOCK:return"stock";case Ue.AGENT:return"agent";case Ue.PROVIDER:return"provider";case Ue.FINANCE:return"finance";case Ue.EMPLOYEE:return"employee";case Ue.EXPERT:return"expert";case Ue.TEACHER:return"teacher";default:return""}},Je=[{label:"平台运营",value:Ue.PLATFORM},{label:"主管单位",value:Ue.APPROVAL},{label:"采购单位",value:Ue.STOCK},{label:"采购代理机构",value:Ue.AGENT},{label:"供应商",value:Ue.PROVIDER},{label:"金融机构",value:Ue.FINANCE},{label:"单位成员",value:Ue.EMPLOYEE},{label:"专家",value:Ue.EXPERT},{label:"教师",value:Ue.TEACHER}],We=[{label:"平台运营",value:$e(Ue.PLATFORM).toUpperCase()},{label:"主管单位",value:$e(Ue.APPROVAL).toUpperCase()},{label:"采购单位",value:$e(Ue.STOCK).toUpperCase()},{label:"采购代理机构",value:$e(Ue.AGENT).toUpperCase()},{label:"供应商",value:$e(Ue.PROVIDER).toUpperCase()},{label:"金融机构",value:$e(Ue.FINANCE).toUpperCase()},{label:"单位成员",value:$e(Ue.EMPLOYEE).toUpperCase()},{label:"专家",value:$e(Ue.EXPERT).toUpperCase()},{label:"教师",value:$e(Ue.TEACHER).toUpperCase()}];(Ze=Ke||(Ke={}))[Ze.ORG_ADMIN=101]="ORG_ADMIN",Ze[Ze.ORG_CHIEF=151]="ORG_CHIEF",Ze[Ze.SYS_RIGHT=102]="SYS_RIGHT",Ze[Ze.SYS_DUTY_MONITOR=104]="SYS_DUTY_MONITOR",Ze[Ze.SYS_DUTY=105]="SYS_DUTY",Ze[Ze.SYS_COM_ADMIN=107]="SYS_COM_ADMIN",Ze[Ze.SYS_GMSOFT_ADMIN=108]="SYS_GMSOFT_ADMIN",Ze[Ze.APPROVAL_ADMIN=201]="APPROVAL_ADMIN",Ze[Ze.APPROVAL_OPER=202]="APPROVAL_OPER",Ze[Ze.APPROVAL_LEADER=203]="APPROVAL_LEADER",Ze[Ze.STOCK_ADMIN=301]="STOCK_ADMIN",Ze[Ze.STOCK_OPER=302]="STOCK_OPER",Ze[Ze.STOCK_LEADER=303]="STOCK_LEADER",Ze[Ze.STOCK_FIN=304]="STOCK_FIN",Ze[Ze.AGENT_ADMIN=401]="AGENT_ADMIN",Ze[Ze.AGENT_OPER=402]="AGENT_OPER",Ze[Ze.AGENT_LEADER=403]="AGENT_LEADER",Ze[Ze.PROVIDER_ADMIN=501]="PROVIDER_ADMIN",Ze[Ze.PROVIDER_OPER=502]="PROVIDER_OPER",Ze[Ze.FINANC_ADMIN=701]="FINANC_ADMIN",Ze[Ze.FINANC_OPER=702]="FINANC_OPER";var en,nn,tn=Ke;(nn=en||(en={}))[nn.EMPLOYEE=101]="EMPLOYEE",nn[nn.EXPERT=102]="EXPERT",nn[nn.TEACHER=103]="TEACHER";var rn,on,an=en;(on=rn||(rn={})).DJC="DJC",on.XCJ="XCJ",on.ZCJ="ZCJ",on.PM="PM",on.ZRTD="ZRTD";var ln=rn;e.LoginByPageOrRegister=function(e){return c.default.createElement(je,g({mode:"page"},e))},e.LoginByPopupOrRegister=function(e){return c.default.createElement(je,g({mode:"popup"},e))},e.OrgIdentityStringOptions=We,e.OrgIdentityType=Xe,e.OrgIdentityTypeOptions=Je,e.RoleType=tn,e.UIType=ln,e.UserIdentity=an,e.angularHTInterceptor=function(e){return Ve(e.tokenParamKey),window.angular.module("HTInterceptor",[]).factory("HTInterceptor",(function(){return{request:function(n){return qe(e,n)}}})).config(["$httpProvider",function(e){e.interceptors.push("HTInterceptor")}]),"HTInterceptor"},e.angularSSOInterceptor=function(e){return window.angular.module("SSOInterceptor",[]).factory("SSOInterceptor",["$injector","$q",function(n,t){return{responseError:function(r){return r&&r.config&&!r.config.SSOInterceptorIgnore&&r&&401===r.status?ke(e,r,n.get("$http"),function(e){return function(){var n=e.get("$rootScope");e.get("$timeout")((function(){n&&!n.$$phase&&n.$apply()}))}}(n)):t.reject(r)}}}]).config(["$httpProvider",function(e){e.interceptors.push("SSOInterceptor")}]),"SSOInterceptor"},e.axiosHTInterceptor=function(e){return Ve(e.tokenParamKey),function(n){return qe(e,n)}},e.axiosSSOInterceptor=function(e){return function(n){return n&&n.config&&!n.config.SSOInterceptorIgnore&&n&&n.response&&401===n.response.status?ke(e,n,s.default):Promise.reject(n)}},e.buildLoginParams=D,e.buildLoginQueryString=function(e){return m(void 0,void 0,void 0,(function(){var n;return h(this,(function(t){switch(t.label){case 0:return[4,D(e)];case 1:return n=t.sent(),[2,f.default.stringify(n,{addQueryPrefix:!0})]}}))}))},e.compatibilityMe=F,e.getOrgIdentityString=$e,e.getToken=Fe,e.getTokenWithKey=Be,e.jumpWithToken=function(e){var n=e.url,t=e.target,r=void 0===t?"_self":t,o=e.extraParams,a=e.qsStringifyOptions,i=Be();if(i){var l=n.split("?"),u=l[0],c=l[1],d=[u,f.default.stringify(g(g(g({},f.default.parse(c)),o),i),g({arrayFormat:"repeat",allowDots:!0},a))].join("?");window.open(d,r)}},e.loginByPage=function(e){return K(g(g({},e),{mode:"page"}))},e.loginByPopup=function(e){return K(g(g({},e),{mode:"popup"}))},e.loginBySSO=Z,e.logout=ue,e.meSelector=de,e.meSeletor=de,e.register=ce,e.requestMeTrySSO=se,e.useMe=Se,Object.defineProperty(e,"__esModule",{value:!0}),e[Symbol.toStringTag]="Module"}));
//# sourceMappingURL=auth-sdk.umd.js.map
